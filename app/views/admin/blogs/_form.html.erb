<div class="panel-body">
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog" id="modal_content" style="padding: 10px;">

    </div>
  </div>
  <h2>ブログ記事作成</h2>

    <%= form_for [:admin, @blog], url: {action: 'confirm'} do |f| %>
      <% custom_errors(@blog) %>
      <div class="row">
        <div class="form-group">
          <div class="col-sm-2">
            <%= f.label "タイトル", class: "form-title pull-right" %>
          </div>
          <div class="col-sm-10">
            <%= f.text_field :title, autofocus: true, class: 'form-control' %>
            <% if @title_error.length > 0 %>
              <div class="error"><%= @title_error.html_safe %></div>
            <% end %>
          </div>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="form-group">
          <div class="col-sm-2">
            <%= f.label "力テゴリ", class: "form-title pull-right" %>
          </div>
          <div class="col-sm-10">
            <%= f.select :category, options_for_select(category_array),class: 'form-control' %>
            <% if @category_error.length > 0 %>
              <div class="error"><%= @category_error.html_safe %></div>
            <% end %>
          </div>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="form-group">
          <div class="col-sm-2">
            <%= f.label "公開日時", class: "form-title pull-right" %>
          </div>
          <div class="col-sm-5">
            <%= f.text_field :publish, class: 'form-control', id: "date_field" %>
            <% if @publish_error.length > 0 %>
              <div class="error"><%= @publish_error.html_safe %></div>
            <% end %>
          </div>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="form-group">
          <div class="col-sm-2">
            <%= f.label "公開設定", class: "form-title pull-right" %>
          </div>
          <div class="col-sm-10">
            <%= f.check_box(:published, {}, "published", "not_published") %> 公開する 
          </div>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="form-group">
          <div class="col-sm-2">
            <%= f.label "オ又又メ", class: "form-title pull-right" %>
          </div>
          <div class="col-sm-10">
            <%= f.check_box(:promoted, {}, "promoted", "not_promoted") %> オ又又メに設定する
          </div>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="form-group">
          <div class="col-sm-2">
            <%= f.label "見出し画傷", class: "form-title pull-right" %>
          </div>
          <div class="col-sm-3">
            <div class="gallery">
              <img src="/assets/author_avatar" alt="image">
            </div>
            <label class="btn btn-default btn-sm" for="blog_image">
              <%= f.file_field :image, style: "display: none;", id: "blog_image" %>
              闔く
            </label>

            <% if @image_error.length > 0 %>
              <div class="error"><%= @image_error.html_safe %></div>
            <% end %>
          </div>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="form-group">
          <div class="col-sm-2">
            <%= f.label "本文", class: "form-title pull-right" %>
          </div>
          <div class="col-sm-10">
            <div id="preview"><%= link_to "プレビュー".html_safe, "#" %></div>
            <br>
            <% if @body_error.length > 0 %>
              <div class="error"><%= @body_error %></div>
            <% end %>
            <div>
              <%= f.text_area :body, class: "form-control ckeditor", id: "body_text" %>
            </div>
          </div>
        </div>
      </div>
      <br>
      <h4>投稿者設定</h4>
      <div class="row">
        <div class="form-group">
          <div class="col-sm-2">
            <%= f.label "名前", class: "form-title pull-right" %>
          </div>
          <div class="col-sm-5">
            <%= f.text_field :author_name, class: "form-control" %>
            <% if @author_name_error.length > 0 %>
              <div class="error"><%= @author_name_error.html_safe %></div>
            <% end %>
          </div>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="form-group">
          <div class="col-sm-2">
            <%= f.label "職業", class: "form-title pull-right" %>
          </div>
          <div class="col-sm-5">
            <%= f.text_field :author_position, class: "form-control" %>
            <% if @author_position_error.length > 0 %>
              <div class="error"><%= @author_position_error.html_safe %></div>
            <% end %>
          </div>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="form-group" data-no-turbolink>
          <div class="col-sm-2">
            <%= f.label "年齢", class: "form-title pull-right" %>
          </div>
          <div class="col-sm-3">
            <%= f.text_field :author_age, type: "number", class: "form-control" %>
            <% if @author_age_error.length > 0 %>
              <div class="error"><%= @author_age_error.html_safe %></div>
            <% end %>
          </div>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="form-group">
          <div class="col-sm-2">
            <%= f.label "画傷", class: "form-title pull-right" %>
          </div>
          <div class="col-sm-3">
            <div class="author_avatar_gallery">
              <img src="/assets/author_avatar" alt="image">
            </div>
            <label class="btn btn-default btn-sm" for="author_avatar_image">
              <%= f.file_field :author_avatar, style: "display: none;", id: "author_avatar_image" %>
              闔く
            </label>
            
            <% if @author_avatar_error.length > 0 %>
              <div class="error"><%= @author_avatar_error.html_safe %></div>
            <% end %>
          </div>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="form-group col-sm-2 col-sm-offset-5">
          <div class="col-sm-6">
            <%= link_to "List", admin_blogs_path, class: "btn btn-default" %>
          </div>
          <div class="col-sm-6">
            <%= f.button "Confirm", class: "btn btn-primary" %>
          </div>
        </div>
      </div>
      <br>
    <% end %>
</div>
<script>
  CKEDITOR.replace('body_text');
  var CKEDITOR_BASEPATH = '/assets/ckeditor/';

  $(function() {
      var imagesPreview = function(input, placeToInsertImagePreview) {

          if (input.files) {
              var filesAmount = input.files.length;

              for (i = 0; i < filesAmount; i++) {
                  var reader = new FileReader();

                  reader.onload = function(event) {
                      $($.parseHTML('<img>')).attr('src', event.target.result).appendTo(placeToInsertImagePreview);
                  }

                  reader.readAsDataURL(input.files[i]);
              }
          }

      };

      $('#blog_image').on('change', function() {
          $('div.gallery').empty();
          imagesPreview(this, 'div.gallery');
      });
      $('#author_avatar_image').on('change', function() {
          $('div.author_avatar_gallery').empty();
          imagesPreview(this, 'div.author_avatar_gallery');
      });
  });

</script>